# Define the path to the text file
$filePath = "C:\path\to\usernames.txt" # Replace with the actual path to your text file

# Define the value for the attribute
$hideFromAddressLists = $true # Set to $false if you want to unhide

# Define the paths for the log files
$successLogPath = "C:\path\to\success.log" # Replace with the actual path to your success log file
$failureLogPath = "C:\path\to\failure.log" # Replace with the actual path to your failure log file

# Import the Active Directory module
Import-Module ActiveDirectory

# Read the usernames from the text file
$usernames = Get-Content -Path $filePath

# Loop through each username and update the attribute
foreach ($userName in $usernames) {
    try {
        # Get the user object
        $user = Get-ADUser -Identity $userName

        # Update the msExchHideFromAddressLists attribute
        Set-ADUser -Identity $user -Replace @{msExchHideFromAddressLists=$hideFromAddressLists}

        # Log success message
        $successMessage = "[$(Get-Date)] Updated msExchHideFromAddressLists for user $userName to $hideFromAddressLists"
        Add-Content -Path $successLogPath -Value $successMessage
    } catch {
        # Log failure message
        $failureMessage = "[$(Get-Date)] Failed to update msExchHideFromAddressLists for user $userName. Error: $_"
        Add-Content -Path $failureLogPath -Value $failureMessage
    }
}

Exception Request Details

Exception Title

Vulnerability Exception Request for Outdated .NET 6 Version on PI Servers

Exception Description

The PI servers in the current environment are running an outdated version of .NET 6, which is flagged as a vulnerability. These servers are scheduled for decommissioning by the end of March 2025, as they will be replaced by new servers. The new servers will adhere to the latest security and compliance standards, including updated .NET versions.

Justification
	1.	Short-term use: The existing PI servers will be operational only until March 2025, after which they will be decommissioned.
	2.	Minimal risk: These servers are in a controlled environment with limited external exposure, minimizing the likelihood of exploitation.
	3.	Resource constraints: Upgrading the .NET version on the current servers would require significant time and effort, which would divert resources from the ongoing migration to the new servers.

Remediation Plan
	1.	Controlled environment: Ensure the servers remain isolated and maintain strict access control.
	2.	Monitoring: Continuously monitor the servers for any signs of vulnerabilities being exploited.
	3.	Replacement timeline: Ensure the decommissioning of existing servers and deployment of new PI servers with updated .NET versions is completed by March 31, 2025.
	4.	Review: Reassess the exception if the decommissioning timeline changes.

Let me know if adjustments are @⁨Udaykumar (Deloitte)⁩ @⁨~Mohanraj⁩ Have 2 questions re: Privpass:
1. What is the process to on-board local windows administrator and Linux root accounts to privpass today? How many account are managed today and for which environment?
2. ⁠are Azure and AWS seed accounts vaulted in Privpass? 

Need this information by 7am CT Monday for a meeting with the client. Pls send me response over an email. We can also have a quick call when one of you is available.
